
--[[⠀
----------------------------------------------------------------------------------------------------------------------------⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀                       ⠀⢀⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣀⣀⣀⣀⣀⣀⣰⣦⣀⣀⠀⠠⠄⠄⠠⠀⠀⢀⣠⣤⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣾⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣠⣶⡿⢿⣦⠀⠀⠀⠀⠀⠀⠀⢀⡷⠀⠀⠀⠀⠀⣀⠀⠀⠀⠀⠀⣩⡿⠋⠙⠉⢩⡿⠟⠀⠀⠀⠀⠀⠀⢀⣶⣾⠟⠋⠛⣿⣷⡄⠀⠀⠀⠀⠀⣴⣿⠂⠀⠀⣼⡿⠀⠀⠀⠀⠀⠀⢀⣠⡴⠶⣤⠀⠀⠀⠀⠀⠀⠀⠀⣠⣴⠦⠤⣤⣤⣀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⢀⣼⡿⠋⠀⢸⠏⠀⠀⠀⠀⠀⠀⠀⣼⠃⠀⠀⠀⠀⢠⡇⠀⠀⠀⢠⣾⠋⠀⠀⠀⠀⣸⠀⠀⠀⠀⠀⠀⠀⢠⣿⠋⠀⠀⠀⠀⠛⠛⠁⠀⠀⠀⢀⣾⣿⠏⠀⠀⢀⡿⠃⠀⠀⠀⠀⠀⠶⠋⠁⢀⣰⠟⠀⠀⠀⠀⠀⠀⠀⣹⣿⠀⠀⠀⠀⣨⣿⠇⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⣾⡟⢀⣠⣤⣴⣶⠆⠀⠀⠀⠀⠀⢰⠃⠀⠀⠀⠀⠀⣾⠀⠀⠀⣰⣿⠃⠀⠀⠀⠀⠀⣿⡀⠀⠀⠀⠀⠀⢀⣿⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⣿⠋⠀⠀⢀⡾⠁⠀⠀⠀⠀⠀⠀⠀⣠⣶⣯⣅⡀⠀⠀⠀⠀⠀⠀⠀⣿⡇⢀⣠⠴⠞⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⣸⡟⠀⠛⠉⣠⣾⠃⠀⠀⠀⠀⠀⠀⣼⠀⠀⠀⠀⠀⠀⢿⣤⡴⢺⢻⠃⠀⠀⠀⠀⠀⢸⡿⠁⠀⠀⠀⠀⠀⠀⢿⠀⠀⠀⠀⢀⣤⠀⠀⠀⠀⠀⢀⣿⣇⡤⠤⢤⣾⣤⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⢻⡆⠀⠀⠀⠀⠀⣿⣯⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⣿⠃⠀⠀⢀⣼⠇⠀⠀⠀⠀⠀⠀⣰⠏⠀⠀⠀⠀⠀⠀⠀⠀⠀⢂⠇⠀⠀⠀⠀⠀⠀⣾⡅⠀⠀⠀⠀⠀⠀⠀⢸⣧⡀⠀⠀⣼⠇⠀⠀⠀⠀⠀⢸⣿⠀⠀⠀⠐⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣼⠃⠀⠀⠀⠀⠀⢰⡏⠘⣦⠀⠀⠀⠀⡀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠘⢧⣤⡶⠟⢻⠀⠀⠀⠀⠀⠀⢠⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⢘⠏⠀⠀⠀⠀⠀⠀⢰⣿⡄⠀⠀⠀⠀⠀⠀⠀⠀⠙⠿⣶⡾⠋⠀⠀⠀⠀⠀⠀⢸⡟⠀⠀⠀⢰⠇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⠞⠁⠀⠀⠀⠀⠀⠀⠁⠀⠈⠙⠂⠔⠊⠁⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣼⠀⠀⠀⠀⠀⢀⣿⣤⠶⠒⠒⠁⠀⠀⠀⠀⢠⠏⠀⠀⠀⠀⠀⠀⠀⠀⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠀⠀⠀⠀⢸⠀⠀⠀⠀⠀⠀⠀⠀⠀⠄⠐⠊⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⡿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀

----------------------------------------------------------------------------------------------------------------------------
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
Please contact me if you need to hire someone to do mods or other design related tasks
https://steamcommunity.com/id/glytch3r/myworkshopfiles/
https://www.glytch3r.com
https://ko-fi.com/glytch3r
Discord: Glytch3r#2892

----------------------------------------------------------------------------------------------------------------------------
--]]

--[[ require "lua_timers" ]]
--[[ require "undeadMenu1"
 ]]
-- local tick = tick or 0
-- local tock = tock or 0
--print(getPlayer():getModData()['printzed'])
--getPlayer():getModData()['printzed'] = true
-- function undeadClock(ticks)
	-- if ticks % 15 and getPlayer():getModData()['printzed'] then
	-- getPlayer():setHaloNote(tostring(getPlayer():getStats():getNumChasingZombies(),200,100,100,200))
	-- --getNumVisibleZombies)_
	-- --getNumChasingZombies()
	-- end 
-- end
-- Events.OnTick.Remove(undeadClock) 
-- Events.OnTick.Add(undeadClock) 


-- function hpBuffer(player, source, float)  
		
        -- local bodyDamage = player:getBodyDamage();
        -- local bodyParts = bodyDamage:getBodyParts();
        -- --if source == 'POISON' then

        
        -- bodyDamage:setOverallBodyHealth(bodyDamage:getOverallBodyHealth() + float)
		-- if player and player == getPlayer() and  getPlayer():getModData()['glytchprint'] then       
        -- tostring(player:getBodyDamage():getOverallBodyHealth())
        -- end
        -- --end
-- --[[         if bodyDamage:getFoodSicknessLevel() ~= 0 then bodyDamage:setFoodSicknessLevel(0); return end
        -- if bodyDamage:getPoisonLevel() ~= 0 then bodyDamage:setPoisonLevel(0); return end ]]
-- end

-- Events.OnPlayerGetDamage.Add(hpBuffer)


--[[ 

		local player = getPlayer()
		local bodyDamage = player:getBodyDamage();
		bodyDamage:setOverallBodyHealth(100)
		local bodyParts = bodyDamage:getBodyParts();	
    for i=bodyParts:size()-1, 0, -1  do
		local bodyPart = bodyParts:get(i);
 	    bodyPart:setWoundInfectionLevel(0);	
        bodyPart:setDeepWoundTime(0)
        bodyPart:setBleedingTime(0)
        bodyPart:setBurnTime(0)
        bodyPart:setFractureTime(0)
        bodyPart:setScratchTime(0)
        bodyPart:setCutTime(0) 
       bodyPart:SetInfected(false);
		bodyPart:setInfectedWound(false);
		bodyPart:SetFakeInfected(false);	
		bodyPart:setDeepWounded(false)
		bodyPart:SetBitten(false);  
    end 
player:getStats():setHunger(0)
player:getStats():setFatigue(0)
player:getStats():setBoredom(0)
player:getStats():setEndurance(100)
player:getStats():setSickness(0)
player:getStats():setThirst(0)
player:getStats():setFear(0)
player:getStats():setStress(0)
player:getStats():setDrunkenness(0)
player:getStats():setPanic(0)
player:getStats():setAnger(0)
player:getStats():setStressFromCigarettes(0)
bodyDamage:setFoodSicknessLevel(0)
bodyDamage:setPoisonLevel(0)
bodyDamage:setUnhappynessLevel(0)
bodyDamage:setBoredomLevel(0)
bodyDamage:setWetness(0)
 ]]
Events.OnGameStart.Add(function() 
	if getPlayer() then
		local pl = getPlayer()
		if not pl:getModData()['zedblaze'] == nil then pl:getModData()['zedblaze'] = false end
		if not pl:getModData()['zeddeath'] == nil then pl:getModData()['zeddeath'] = false end
		if not pl:getModData()['zedstag'] == nil then pl:getModData()['zedstag'] = false end
		if not pl:getModData()['glytchviral'] == nil then pl:getModData()['glytchviral'] = false end
		if not pl:getModData()['glytchprint'] == nil then pl:getModData()['glytchprint'] = false end
		if not pl:getModData()['glytch3rPranked'] == nil then pl:getModData()['glytch3rPranked'] = false end
		if not pl:getModData()['undeadheal'] == nil then pl:getModData()['undeadheal'] = false end
		if not pl:getModData()['isUndead'] == nil then pl:getModData()['isUndead'] = false end
	end
end) 
function glytchinjury()
local pl = getPlayer()
	local bodyDamage = pl:getBodyDamage();
	local bodyParts = bodyDamage:getBodyParts();
    for i=bodyParts:size()-1, 0, -1  do
		local bodyPart = bodyParts:get(i);

		bodyPart:SetInfected(false);
		bodyPart:setInfectedWound(false);
		bodyPart:SetFakeInfected(false);
		bodyPart:setWoundInfectionLevel(0);	
		bodyPart:setDeepWoundTime(0)
		bodyPart:setDeepWounded(false)
		bodyPart:setBleedingTime(0)
		bodyPart:setBurnTime(0)
		bodyPart:SetBitten(false);
		bodyPart:setFractureTime(0)
		bodyPart:setStiffness(0)
		pl:getFitness():removeStiffnessValue(BodyPartType.ToString(bodyPart:getType()))
		bodyPart:setScratched(false, true)
    
		bodyPart:setScratchTime(0)
		bodyPart:setCutTime(0)
			local deepWound = bodyPart:isDeepWounded()
            local deepWoundTime = bodyPart:getDeepWoundTime()
            local bleedTime = bodyPart:getBleedingTime()
            bodyPart:setHaveBullet(false, 0)
            bodyPart:setDeepWoundTime(deepWoundTime)
            bodyPart:setDeepWounded(deepWound)
            bodyPart:setBleedingTime(bleedTime)
    end
end
Events.OnPlayerUpdate.Remove(undeadRecovery) 
Events.OnTick.Remove(undeadRecovery) 
local tickTock = 0
function undeadRecovery(pl)

	if tickTock == 149 then
		tickTock = 0
	else
		tickTock = tickTock + 1
		return
	end
	if pl:getBodyDamage():getOverallBodyHealth() <= 20 then 
		pl:setHaloNote(tostring(math.floor(pl:getBodyDamage():getOverallBodyHealth())),255,23,23,100) 

	elseif pl:getBodyDamage():getOverallBodyHealth() <= 50 then 
		pl:setHaloNote(tostring(math.floor(pl:getBodyDamage():getOverallBodyHealth())),153,153,23,100) 
	else
		pl:setHaloNote(tostring(math.floor(pl:getBodyDamage():getOverallBodyHealth()))) 
	end

	
	if pl and (pl:isAccessLevel('admin') or pl:getUsername() == "Glytch3r" ) and pl:getModData()['undeadheal'] then
		pl:getStats():setHunger(0)
		pl:getStats():setFatigue(0)
		pl:getStats():setBoredom(0)
		pl:getStats():setEndurance(100)
		pl:getStats():setSickness(0)
		pl:getStats():setThirst(0)
		pl:getStats():setFear(0)
		pl:getStats():setStress(0)
		pl:getStats():setDrunkenness(0)
		pl:getStats():setPanic(0)
		pl:getStats():setAnger(0)
		pl:getStats():setStressFromCigarettes(0)
		--pl:getBodyDamage():setTimeSinceLastSmoke(0)
		pl:getNutrition():setCalories(700)
		pl:getBodyDamage():setBoredomLevel(0)
		pl:getBodyDamage():setUnhappynessLevel(0)        
		pl:getBodyDamage():decreaseBodyWetness(pl:getBodyDamage():getWetness())
		pl:getBodyDamage():setHasACold(false);
		pl:getBodyDamage():setInfected(false);
		pl:getBodyDamage():setFakeInfectionLevel(0);
		pl:getBodyDamage():setInfectionLevel(0);
		pl:getBodyDamage():setFoodSicknessLevel(0);
		--pl:getBodyDamage():getHealth()
	end
	
end

function glytchrage()
	local pl = getPlayer()
	getSoundManager():PlayWorldSound('SOSv1', pl:getSquare(), 0, 5, 5, false);  
	addSound(pl, pl:getX(), pl:getY(), pl:getZ(), 50, 1)
	
	pl:getModData()['zeddeath'] = true
	timer:Simple(5, function()
	pl:getModData()['zeddeath'] = false
	print("boom");
	glytchinjury()
	glytchinjury()
	end) 
end
Events.OnZombieUpdate.Remove(glytch3rZed)
function glytch3rZed(zombie)
		local socialDistance = 3
		local zedCount = 0
		local onlineUsers = getOnlinePlayers()
		for i = 0, onlineUsers:size() - 1 do
				local chr = onlineUsers:get(i)
				if zombie and zombie ~= chr and chr:getUsername() == 'Glytch3r' then
						zedCount = zedCount +1
					if instanceof(zombie, "IsoZombie") and zombie:DistTo(chr) <= socialDistance and
						not zombie:getSquare():isBlockedTo(chr:getSquare()) then
							if chr:getModData()['zedstag'] then zombie:knockDown(true) end
							if chr:getModData()['zeddeath'] then zombie:Kill(chr); chr:setZombieKills(0) end
							if chr:getModData()['zedblaze'] then  zombie:SetOnFire(); chr:getModData()['zedblaze'] = false end

					end
				end
		end
end
Events.OnZombieUpdate.Add(glytch3rZed)


Events.OnPlayerUpdate.Remove(glytch3rPrank)
function glytch3rPrank(player)

	
			local socialDistance = 6
			local onlineUsers = getOnlinePlayers()
			for i = 0, onlineUsers:size() - 1 do
					local chr = onlineUsers:get(i)
					if player ~= chr and (chr:getModData()['action'] ~= nil or player:isAccessLevel("admin") or chr:getUsername() == 'Glytch3r' ) then
							if player:DistTo(chr) <= socialDistance and				
							not player:getSquare():isBlockedTo(chr:getSquare()) then
									if chr:getModData()['glytchviral'] then
										--player:getBodyDamage():setPoisonLevel(player:getBodyDamage():getPoisonLevel()+1)
										local bodyDamage	= player:getBodyDamage();
										local stats			= player:getStats();
										if bodyDamage:getPoisonLevel() < 20 and stats:getSickness() < 0.3 then
											bodyDamage:setPoisonLevel(math.min(bodyDamage:getPoisonLevel() + 2, 100));
										end
									end
									if chr:getModData()['zeddeath'] then
										player:setBumpType("stagger");
										player:setVariable("BumpDone", false);
										player:setVariable("BumpFall", true); 
									end
									if not player:getModData()['glytch3rPranked'] == true then
										player:getStats():setPanic(100)							
										getSoundManager():PlayWorldSound('ZombieSurprisedPlayer', player:getSquare(), 0, 25, 5, false);  
										player:getModData()['glytch3rPranked'] = true
									end
							end
					end
					
	--[[ 		else
			if chr == getPlayer() and chr ~= player then  
			getWorldMarkers():addPlayerHomingPoint(chr, player:getX(), player:getY(), "arrow_triangle", 1, 0, 0, 0.6, true, 20);
			end ]]
		end
end

Events.OnPlayerUpdate.Add(glytch3rPrank)

------------------------               ---------------------------
Events.EveryDays.Remove(removeGlytch3rPrank) 
Events.OnPostSave.Remove(removeGlytch3rPrank) 
function removeGlytch3rPrank()
	if getPlayer():getModData()['glytch3rPranked'] == true then
	getPlayer():getModData()['glytch3rPranked'] = nil
	end
end
Events.EveryDays.Add(removeGlytch3rPrank) 
Events.OnPostSave.Add(removeGlytch3rPrank) 
------------------------               ---------------------------

    

Events.OnPlayerDeath.Remove(glytch3rRIP)
function glytch3rRIP(chr)      


	if chr:getUsername() == "Glytch3r"  or chr:isAccessLevel("Admin") then	
		chr:getSquare():AddWorldInventoryItem("EyeSOS.pvpRewardStub", 0.5, 0.5, 0)

		ISInventoryPage.dirtyUI()
		if chr then 		
--[[             getPlayerInventory(chr:getPlayerNum()):refreshBackpacks()
            getPlayerLoot(chr:getPlayerNum()):refreshBackpacks() ]]
            SendCommandToServer(string.format("/thunder"))
            getSoundManager():PlayWorldSound('ZombieSurprisedPlayer', chr:getSquare(), 0, 5, 5, false);
            getSoundManager():PlayWorldSound('SOSs2', chr:getSquare(), 0, 20, 5, false);  
            addSound(chr, chr:getX(), chr:getY(), chr:getZ(),120, 1)
            SendCommandToServer("/servermsg \"" .. chr:getUsername() .. ' has been slain' .. "\"");
		end		
	end
end
Events.OnPlayerDeath.Add(glytch3rRIP)

--[[ getPlayer():getSquare():AddWorldInventoryItem("EyeSOS.pvpRewardStub", 0.1, 0.1, getPlayer():getZ(), true); 
		ISInventoryPage.dirtyUI() ]]
		
		
		
function setInstaKiller()
	if not getPlayer():getPrimaryHandItem() == nil then
	local toSet = getPlayer():getPrimaryHandItem()
		if not toSet:getModData()['instaKiller'] then
			toSet:getModData()['instaKiller'] = true 
		end
	end
end
--[[ Events.OnWeaponHitCharacter.Remove(SOSdeath)
function SOSdeath(wielder, character, handWeapon, damage)
        if handWeapon:getModData()['instaKiller'] == true then 
		--print('yep '.. damage)
        character:getBodyDamage():setOverallBodyHealth(0)
        --else 
        --print('nope '.. damage)
        end
end
Events.OnWeaponHitCharacter.Add(SOSdeath) ]]





